# The schema version. Required. Must be exactly the string "integration/v1".
apiVersion: integration/v1

# The schema kind. Required. Must be one of "Query", "Step", or "Trigger"
# corresponding to its directory location.
kind: Step

# The name of the action. Required. Must be exactly the name of the directory
# containing the action.
name: kubernetes-step-kubectl

# The version of the action. Required. Must be an integer. If specified in the
# directory name, must be exactly the version in the directory name.
version: 3

# High-level phrase describing what this action does. Required.
summary: Kubectl

# Single-paragraph explanation of what this action does in more detail.
# Optional. Markdown.
description: This Kubectl step container allows general `kubectl` use and can take `kubectl` commands.

# URL or path relative to this file to an icon or icons representing this
# action. Optional. Defaults to the integration icon.
icon:

schemas:
  spec:
    $schema: http://json-schema.org/draft-07/schema#
    type: object
    required:
    - cluster
    - command
    properties:
      cluster:
        type: object
        required:
        - name
        - connection
        properties:
          name:
            type: string
          connection:
            type: object
            required:
            - clusterServer
            - certificateAuthority
            - token
            properties:
              clusterServer:
                type: string
                format: uri
              certificateAuthority:
                type: string
              token:
                type: string
      command:
        type: string
      args:
        type: array
        items:
          type: string
      file:
        type: string
      namespace:
        type: string
      git:
        type: object
        required:
        - ssh_key
        - known_hosts
        - name
        - repository
        properties:
          ssh_key:
            type: string
          known_hosts:
            type: string
          name:
            type: string
          branch:
            type: string
          repository:
            type: string

# The mechanism to use to construct this step. Required. Must be an action
# builder. See the Builders section below.
build:
  # The schema version for builders. Required. For now, must be the exact
  # string "build/v1". We may consider supporting custom third-party builders
  # in the future.
  apiVersion: build/v1

  # The builder to use. Required.
  kind: Docker

publish:
  repository: relaysh/kubernetes-step-kubectl
